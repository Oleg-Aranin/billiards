(this["webpackJsonpd3-app"]=this["webpackJsonpd3-app"]||[]).push([[0],{32:function(e,t,a){e.exports=a.p+"static/media/monster-marbles-sprite-sheets.edcc46e8.jpg"},34:function(e,t,a){e.exports=a(90)},39:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(12),s=a.n(i),c=(a(39),a(9)),l=a(14),o=a(15),u=a(1),h=a(20),m=a(93),y=a(94),b=function(){function e(){Object(l.a)(this,e),this.MarbleR=25,this.width=800,this.height=600,this.marbles=[],this.timer=null}return Object(o.a)(e,[{key:"startGameLoop",value:function(){var e=this;this.marbles=this.initialPositions,this.timer=Object(m.a)((function(){return e.simulationStep()}))}},{key:"simulationStep",value:function(){var e=this,t=this.width,a=this.height,r=this.MarbleR;this.marbles.forEach((function(n,i){var s=function(n){var i=n.x,s=n.y,c=n.vx,l=n.vy,o=n.id,u=.99*(i+c<r?-c:i+c>t-r?-c:c),h=.99*(s+l<r?-l:s+l>a-r?-l:l),m=Object(y.a)().extent([[-1,-1],[e.width+1,e.height+1]]).x((function(e){return e.x})).y((function(e){return e.y})).addAll(e.marbles.filter((function(e){return o!==e.id}))).find(i,s,2*r);if(m){var b=m.x-i,p=m.y-s,d=(u*b+h*p)/(Math.pow(b,2)+Math.pow(p,2))*2.3;u=(u-d*b)/2.3,h=(h-d*p)/2.3,m.vx+=-u,m.vy+=-h,m.x+=-u,m.y+=-h}return{x:i+u,y:s+h,vx:u,vy:h}}(n),c=s.x,l=s.y,o=s.vx,u=s.vy;e.marbles[i].x=c,e.marbles[i].y=l,e.marbles[i].vx=o,e.marbles[i].vy=u}))}},{key:"shoot",value:function(e,t){var a=e.x,r=e.y,n=e.vx,i=e.vy;this.marbles[t].x=a,this.marbles[t].y=r,this.marbles[t].vx=n<20?n:20,this.marbles[t].vy=i<20?i:20}},{key:"initialPositions",get:function(){var e=this,t=this.width,a=this.height,r=this.MarbleR,n=t/2,i=Object(h.a)(4,0,-1).map((function(t){if(4===t)return[{x:n,y:200,vx:0,vy:0,r:e.MarbleR}];var a=n-t*(r+5),i=n+t*(r+5);return Object(h.a)(a,i,2*r+5).map((function(a){return{x:a,y:200-t*(2*r+5),vx:0,vy:0,r:e.MarbleR}}))})).reduce((function(e,t){return e.concat(t)}),[]);return(i=[].concat(i,{x:t/2,y:a-150,vx:0,vy:0,r:this.MarbleR})).forEach((function(e,t){return i[t].id=t})),i}}]),e}();Object(u.h)(b,{MarbleR:u.m,width:u.m,height:u.m,marbles:u.m,initialPositions:u.e,startGameLoop:u.d,simulationStep:u.d,shoot:u.d});var p=new b,d=a(32),f=a.n(d),v={dino:{x:-222,y:-177,c:"#8664d5"},redHeart:{x:-222,y:-299,c:"#e47178"},sun:{x:-222,y:-420,c:"#5c96ac"},yellowHeart:{x:-400,y:-177,c:"#c8b405"},mouse:{x:-400,y:-299,c:"#7d7e82"},pumpkin:{x:-400,y:-420,c:"#fa9801"},frog:{x:-576,y:-177,c:"#98b42b"},moon:{x:-575,y:-299,c:"#b20717"},bear:{x:-576,y:-421,c:"#a88534"}},x=function(){function e(){Object(l.a)(this,e),this.sprite=null}return Object(o.a)(e,[{key:"loadSprite",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},a=new Image;a.src=f.a,a.onload=function(){e.sprite=a,t()}}},{key:"marbleTypes",get:function(){return Object.keys(v)}},{key:"MarbleDefinitions",get:function(){return v}}]),e}();Object(u.h)(x,{sprite:u.m,loadSprite:u.d,marbleTypes:u.e,MarbleDefinitions:u.e});var g=new x,w=a(10),O=a(33),j=Object(c.a)((function(e){var t=Object(r.useState)(null),a=Object(O.a)(t,2),i=a[0],s=a[1],c=Object(r.useRef)(null),l=e.sprite,o=e.type,u=(e.draggable,e.id),h=e.physics,m=l.MarbleDefinitions,y=h.marbles[u],b=y.x,p=y.y,d=y.r;return n.a.createElement(w.Circle,{x:b,y:p,radius:d,fillPatternImage:l.sprite,fillPatternOffset:m[o],fillPatternScale:{x:2*d/111,y:2*d/111},shadowColor:m[o].c,shadowBlur:15,shadowOpacity:1,draggable:!0,onDragStart:function(){var t=e.physics,a=e.id;s({origX:t.marbles[a].x,origY:t.marbles[a].y,startTime:new Date})},onDragEnd:function(){var t=e.physics,a=i.origX,r=i.origY,n=c.current.attrs,s=n.x,l=n.y,o=new Date-i.startTime,u=Math.pow(s-a,2)+Math.pow(l-r,2),h=Math.sqrt(u)/(o/16);t.shoot({x:s,y:l,vx:(s-a)/(h/3),vy:(l-r)/(h/3)},e.id)},onDragMove:function(){var t=e.physics,a=e.id,r=c.current.attrs,n=r.x,i=r.y;t.marbles[a].x=n,t.marbles[a].y=i},ref:c})})),E=Object(c.a)((function(){var e=p.width,t=p.height,a=p.marbles,r=g.marbleTypes;return n.a.createElement(w.Stage,{width:e,height:t},n.a.createElement(w.Layer,null,n.a.createElement(w.Group,null,a.map((function(e,t){var a=e.x,i=e.y,s=e.id;return n.a.createElement(j,{x:a,y:i,type:r[t%r.length],draggable:!0,id:s,key:"marble - ".concat(s),physics:p,sprite:g})})))))})),M=Object(c.a)((function(){return Object(r.useEffect)((function(){g.loadSprite((function(){return p.startGameLoop()}))}),[]),n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"App-header"},n.a.createElement("h2",null,"Billiards"),n.a.createElement("p",null,"Render on canvas, build with React and Konva")),n.a.createElement("div",{className:"App-intro"},n.a.createElement(E,null)))}));s.a.render(n.a.createElement(M,null),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.cf97bd43.chunk.js.map